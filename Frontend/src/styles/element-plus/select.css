/* =========================================================
   Element Plus: Select (trigger + dropdown) — token driven
   Fix: dropdown item hover/selected turning WHITE in dark mode
========================================================= */

/* ---------------------------------------------------------
   1) Trigger (input wrapper)
--------------------------------------------------------- */

.el-select__wrapper {
    border-radius: var(--border-radius-base, 10px);
    background: var(--input-bg, var(--color-card)) !important;
    box-shadow: 0 0 0 1px var(--input-border, var(--border-color)) inset !important;

    transition:
        box-shadow var(--transition-base),
        background-color var(--transition-base),
        transform var(--transition-base);
}

/* Hover */
.el-select__wrapper.is-hovering:not(.is-focused) {
    box-shadow: 0 0 0 1px color-mix(in srgb, var(--input-border, var(--border-color)) 40%, var(--color-primary) 60%) inset !important;
}

/* Focus */
.el-select__wrapper.is-focused {
    box-shadow: 0 0 0 1px var(--color-primary) inset !important;
    transform: translateY(-0.5px);
}

/* Arrow / icons */
.el-select__caret,
.el-select__icon,
.el-select__suffix {
    color: var(--muted-color) !important;
}

.el-select__wrapper.is-focused .el-select__caret,
.el-select__wrapper.is-focused .el-select__icon {
    color: var(--color-primary) !important;
}

/* Multiple: nicer padding/height */
.el-select--multiple .el-select__wrapper {
    min-height: 36px;
    padding: 2px 10px;
}

/* Multiple tags should follow your tag system */
.el-select--multiple .el-select__tags .el-tag {
    background: var(--hover-bg) !important;
    border-color: color-mix(in srgb, var(--border-color) 55%, var(--color-primary) 45%) !important;
    color: var(--color-primary) !important;
}

.el-select--multiple .el-select__tags .el-tag .el-tag__close {
    color: var(--color-primary) !important;
}

.el-select--multiple .el-select__tags .el-tag .el-tag__close:hover {
    background: var(--active-bg) !important;
    color: var(--color-light) !important;
}

/* ---------------------------------------------------------
   2) Dropdown panel surface (popper)
--------------------------------------------------------- */

/* the popper container */
.el-select__popper.el-popper,
.el-popper.el-select__popper {
    background: var(--color-card) !important;
    border: 1px solid var(--border-color) !important;
    border-radius: 14px !important;
    box-shadow: 0 16px 34px var(--card-shadow) !important;
    overflow: hidden;
}

/* arrow */
.el-select__popper.el-popper .el-popper__arrow::before,
.el-popper.el-select__popper .el-popper__arrow::before {
    background: var(--color-card) !important;
    border: 1px solid var(--border-color) !important;
}

/* dropdown inner */
.el-select-dropdown {
    background: transparent !important;
    padding: 6px !important;
}

/* ---------------------------------------------------------
   3) Dropdown items (THIS fixes the white hover/selected)
--------------------------------------------------------- */

.el-select-dropdown__item {
    /* reset EP defaults that can become white */
    background: transparent !important;

    border-radius: 10px;
    margin: 2px 0;
    padding: 0 10px;

    color: color-mix(in srgb, var(--text-color) 88%, var(--muted-color) 12%) !important;
    font-weight: 600;

    transition:
        background-color var(--transition-base),
        color var(--transition-base);
}

/* Hover states (EP uses both :hover and .hover in places) */
.el-select-dropdown__item:hover,
.el-select-dropdown__item.hover {
    background: var(--hover-bg) !important;
    color: var(--text-color) !important;
}

/* Selected states (EP can use .selected OR .is-selected depending on version) */
.el-select-dropdown__item.selected,
.el-select-dropdown__item.is-selected {
    background: var(--active-bg) !important;
    color: var(--color-primary) !important;
    font-weight: 800;
}

/* Selected + hover (keep consistent, never white) */
.el-select-dropdown__item.selected:hover,
.el-select-dropdown__item.selected.hover,
.el-select-dropdown__item.is-selected:hover,
.el-select-dropdown__item.is-selected.hover {
    background: color-mix(in srgb, var(--active-bg) 65%, var(--hover-bg) 35%) !important;
    color: var(--color-primary) !important;
}

/* Disabled item (avoid white “chip” look) */
.el-select-dropdown__item.is-disabled {
    background: transparent !important;
    color: color-mix(in srgb, var(--muted-color) 78%, transparent) !important;
    opacity: 0.8;
}

/* Disabled hover should not change bg */
.el-select-dropdown__item.is-disabled:hover,
.el-select-dropdown__item.is-disabled.hover {
    background: transparent !important;
    color: color-mix(in srgb, var(--muted-color) 78%, transparent) !important;
}

/* Optional: group title */
.el-select-group__title {
    color: color-mix(in srgb, var(--muted-color) 80%, var(--text-color) 20%);
    font-weight: 650;
    padding: 6px 10px;
}

/* ---------------------------------------------------------
   4) Dark mode: extra safety (if any EP var leaks “white”)
--------------------------------------------------------- */

html[data-theme="dark"] .el-select__popper.el-popper,
html[data-theme="dark"] .el-popper.el-select__popper {
    background: color-mix(in srgb, var(--color-card) 96%, var(--color-bg) 4%) !important;
    border-color: color-mix(in srgb, var(--border-color) 80%, var(--color-primary) 20%) !important;
}

/* If ANY selected item still turns white, force a darker mix */
html[data-theme="dark"] .el-select-dropdown__item.selected,
html[data-theme="dark"] .el-select-dropdown__item.is-selected {
    background: color-mix(in srgb, var(--color-card) 78%, var(--color-primary) 22%) !important;
}